# Проект 1C DevOps

**Цель проекта**: контейниризация сервера 1C:Предприятие.

## Документация

### Как запустить?
`docker compose up -d` построит все контейнеры и запустит их.

### Как отлаживать?
`docker compose logs <имя сервиса>`, где имя сервиса одно из `1c-server`, `1c-postgres`, `1c-proxy`.

### Сервисы
- `1c-server` - основной контейнер, в котором разворачивается сервер 1С:Предприятие. При создании проекта используется дистрибутив для Linux, ожидается, что он будет находится в папке `1c-server` под именем `server.zip`.
- `1c-postgres` - контейнер, в котором разворачивается PostgreSQL для хранения информационных баз. В качестве дистрибутива используется версия PostgreSQL от Postgres PRO ввиду её совместимости с 1С:Предприятие.
- `1c-proxy` - контейнер, который проксирует доступ к опубликованной в web информационной базе с помощью nginx. Добавляет поддержку HTTPS с помощью сертификатов в папке `certs`.

### Конфигурация
Сервис `1c-server` предоставляет переменные среды, которые влияют на конфигурацию:
- `VIRTUAL_HOST` - доменное имя, по которому прокси понимает, что трафик предназначен для сервера 1С:Предприятие.
- `VIRTUAL_PORT` - порт, на который проксируется трафик. На этом порту должна быть опубликованная в web информационная база.
- `HTTPS_METHOD` - политика HTTPS. Прокси поддерживает переадресацию HTTP трафика на HTTPS или полное отключение возможности связи по HTTP.
- `DBNAME` - имя информационной базы. Также тспользуется при создании базы данных на сервере PostgreSQL.
- `DBSERVER` - адрес сервера баз данных.
- `DBUSER` - имя пользователя, которое используется при подключении к серверу баз данных.

## Чего нет
- Health-check, так как не используется Kubernetes.
- Автоматическая пересборка, так как нет доступа к полноценному релизу 1С:Предприятие.
- Лицензии на сервер, так как коммьюнити-лицензия не предусматривает активацию сервера.
